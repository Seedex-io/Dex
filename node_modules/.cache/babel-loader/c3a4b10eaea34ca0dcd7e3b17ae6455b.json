{"ast":null,"code":"import _asyncToGenerator from\"/workspaces/Dex/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspaces/Dex/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/workspaces/Dex/node_modules/@babel/runtime/regenerator/index.js\";import{useEffect,useState}from'react';import{getInfo}from'../../api/getInfo';import{formatNumber}from'../../utils/helpers/numberFormat';import'./styles.css';import Div from'../SimpleComponents/Div';import Header from'./Header';import General from'./General';import{BrowserView,MobileView}from'react-device-detect';import Img from'../SimpleComponents/Img';import Button from'../Button';import logoMain from'../../assets/logo.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function TokenInfo(props){var visible=props.visible,onSetAddress=props.onSetAddress,onSetAddressFinish=props.onSetAddressFinish;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),showMore=_useState4[0],setShowMore=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];// Error state to track fetch failures\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];// Loading state to manage loading behavior\nvar setInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);// Set loading to true when starting the API call\n_context.prev=1;_context.next=4;return getInfo();case 4:data=_context.sent;if(data){setToken(data);onSetAddress(data.pairAddress,data.symbol,data.tokenAddress);document.title=\"\".concat(data.symbol,\" - $\").concat(formatNumber(data.price),\", \").concat(data.name);onSetAddressFinish();setError(null);// Clear any previous errors\n}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);setError('Failed to fetch token info. Retrying...');case 11:_context.prev=11;setLoading(false);// Set loading to false after the API call is complete\nreturn _context.finish(11);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,8,11,14]]);}));return function setInfo(){return _ref.apply(this,arguments);};}();useEffect(function(){setInfo();// Fetch token info on mount\n// If an error occurs, attempt to refetch every 60 seconds\nvar interval=setInterval(function(){if(error){setInfo();// Retry fetch only if there was an error\n}},60000);return function(){return clearInterval(interval);};// Cleanup interval on component unmount\n},[error]);// Dependency on error to trigger refetch in case of failure\nvar renderSimpleInfo=function renderSimpleInfo(){return/*#__PURE__*/_jsxs(Div,{className:\"flex items-center gap-3 px-3 py-2 md:border-l-2 md:py-3 border-fuchsia-400 bg-fuchsia-950/20 border-l rounded-sm\",children:[/*#__PURE__*/_jsx(Img,{className:\"relative rounded-full mb-2 ml-1.5 h-[36px] w-[36px] border-2 sm:h-[42px] sm:w-[42px]\",src:token.logo||logoMain,alt:token.symbol}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-1 min-w-0 flex-1 flex flex-col md:ml-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-white gap-1 max-w-[200px] pr-1 overflow-hidden text-ellipsis whitespace-nowrap\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[1.1em] font-bold leading-tight\",children:token.baseToken.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-[1.1em] font-normal leading-tight\",children:[\"/ \",token.quoteToken.symbol]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold \".concat(token.price24hChange>0?'text-green-500':'text-red-500'),children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-[16px] inline-flex gap-[1px] font-semibold overflow-hidden text-ellipsis whitespace-nowrap leading-[1.3] rounded-[6px]\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"opacity-60\",children:\"$\"}),formatNumber(token.price)]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center text-white gap-1 max-w-[200px] pr-1 overflow-hidden text-ellipsis whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-[0.9em] opacity-70 text-white leading-[1.1em] max-w-[200px] overflow-hidden text-ellipsis whitespace-nowrap\",children:token.baseToken.symbol})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold \".concat(token.price24hChange>0?'text-green-500':'text-red-500'),children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm leading-[1.43] font-medium overflow-hidden text-ellipsis whitespace-nowrap\",children:[/*#__PURE__*/_jsx(\"svg\",{stroke:\"currentColor\",fill:\"currentColor\",strokeWidth:\"0\",viewBox:\"0 0 24 24\",className:\"inline-block items-center justify-center \".concat(token.price24hChange>0?'':'rotate-180'),height:\"1em\",width:\"1em\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M5 15h14l-7-8z\"})}),formatNumber(token.price24hChange),\"%\"]})})]})]})]});};var renderShowMoreButtons=function renderShowMoreButtons(){return/*#__PURE__*/_jsxs(Div,{className:\"token_info__show_more_buttons flex justify-between mt-5\",children:[/*#__PURE__*/_jsx(Button,{title:\"About\",onClick:function onClick(){return setShowMore(showMore===1?0:1);},focus:showMore===1}),/*#__PURE__*/_jsx(Button,{title:\"More Info\",onClick:function onClick(){return setShowMore(showMore===2?0:2);},focus:showMore===2})]});};var renderShowMoreOptions=function renderShowMoreOptions(){switch(showMore){case 1:return/*#__PURE__*/_jsx(Header,{token:token,setToken:setToken});case 2:return/*#__PURE__*/_jsx(General,{token:token});default:return null;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-full overflow-y-auto px-5 py-4 border-l-[#651e6e] flex flex-1 flex-col gap-3 pb-1 md:border-l md:pb-6 text-white\",children:[visible&&/*#__PURE__*/_jsxs(_Fragment,{children:[renderSimpleInfo(),/*#__PURE__*/_jsxs(MobileView,{children:[renderShowMoreButtons(),renderShowMoreOptions()]}),/*#__PURE__*/_jsxs(BrowserView,{children:[/*#__PURE__*/_jsx(Header,{token:token,setToken:setToken}),/*#__PURE__*/_jsx(General,{token:token})]})]}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"}),\"  \",error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),\"  \"]});}","map":null,"metadata":{},"sourceType":"module"}