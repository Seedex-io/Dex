!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).HexToCSSFilter={})}(this,function(t){"use strict";var c=(e.prototype.set=function(t,e,s){this.r=this.clamp(t),this.g=this.clamp(e),this.b=this.clamp(s)},e.prototype.hueRotate=function(t){void 0===t&&(t=0),t=t/180*Math.PI;var e=Math.sin(t),s=Math.cos(t);this.multiply([.213+.787*s-.213*e,.715-.715*s-.715*e,.072-.072*s+.928*e,.213-.213*s+.143*e,.715+.285*s+.14*e,.072-.072*s-.283*e,.213-.213*s-.787*e,.715-.715*s+.715*e,.072+.928*s+.072*e])},e.prototype.grayscale=function(t){void 0===t&&(t=1),this.multiply([.2126+.7874*(1-t),.7152-.7152*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152+.2848*(1-t),.0722-.0722*(1-t),.2126-.2126*(1-t),.7152-.7152*(1-t),.0722+.9278*(1-t)])},e.prototype.sepia=function(t){void 0===t&&(t=1),this.multiply([.393+.607*(1-t),.769-.769*(1-t),.189-.189*(1-t),.349-.349*(1-t),.686+.314*(1-t),.168-.168*(1-t),.272-.272*(1-t),.534-.534*(1-t),.131+.869*(1-t)])},e.prototype.saturate=function(t){void 0===t&&(t=1),this.multiply([.213+.787*t,.715-.715*t,.072-.072*t,.213-.213*t,.715+.285*t,.072-.072*t,.213-.213*t,.715-.715*t,.072+.928*t])},e.prototype.multiply=function(t){var e=this.clamp(this.r*t[0]+this.g*t[1]+this.b*t[2]),s=this.clamp(this.r*t[3]+this.g*t[4]+this.b*t[5]),r=this.clamp(this.r*t[6]+this.g*t[7]+this.b*t[8]);this.r=e,this.g=s,this.b=r},e.prototype.brightness=function(t){void 0===t&&(t=1),this.linear(t)},e.prototype.contrast=function(t){void 0===t&&(t=1),this.linear(t,-.5*t+.5)},e.prototype.linear=function(t,e){void 0===t&&(t=1),void 0===e&&(e=0),this.r=this.clamp(this.r*t+255*e),this.g=this.clamp(this.g*t+255*e),this.b=this.clamp(this.b*t+255*e)},e.prototype.invert=function(t){void 0===t&&(t=1),this.r=this.clamp(255*(t+this.r/255*(1-2*t))),this.g=this.clamp(255*(t+this.g/255*(1-2*t))),this.b=this.clamp(255*(t+this.b/255*(1-2*t)))},e.prototype.hsl=function(){var t=this.r/255,e=this.g/255,s=this.b/255,r=Math.max(t,e,s),i=Math.min(t,e,s),a=0,o=(r+i)/2;if(r===i)return{h:0,s:0,l:100*o};var n=r-i,h=.5<o?n/(2-r-i):n/(r+i);switch(r){case t:a=(e-s)/n+(e<s?6:0);break;case e:a=(s-t)/n+2;break;case s:a=(t-e)/n+4}return{h:100*(a/=6),s:100*h,l:100*o}},e.prototype.clamp=function(t){return Math.min(Math.max(t,0),255)},e);function e(t,e,s){this.r=0,this.g=0,this.b=0,this.set(t,e,s)}var p=(s.prototype.solve=function(){var t=this.solveNarrow(this.solveWide());return{values:t.values,called:t.called,loss:t.loss,filter:this.css(t.values)}},s.prototype.solveWide=function(){for(var t=[60,180,18e3,600,1.2,1.2],e={loss:1/0},s=0;e.loss>this.options.acceptanceLossPercentage;){var r=this.spsa({A:5,a:t,c:15,values:[50,20,3750,50,100,100],maxTriesInLoop:1e3});if(r.loss<e.loss&&(e=r),(s+=1)>=this.options.maxChecks)break}return Object.assign({},e,{called:s})},s.prototype.solveNarrow=function(t){var e=t.loss,s=e+1,r=[.25*s,.25*s,s,.25*s,.2*s,.2*s];return this.spsa({A:e,a:r,c:2,values:t.values,maxTriesInLoop:500,called:t.called})},s.prototype.fixValueByFilterIDX=function(t,e){var s=100;return 2===e?s=7500:4!==e&&5!==e||(s=200),3===e?s<t?t%=s:t<0&&(t=s+t%s):t<0?t=0:s<t&&(t=s),t},s.prototype.spsa=function(t){for(var e=t.A,s=t.a,r=t.c,i=t.values,a=t.maxTriesInLoop,o=void 0===a?500:a,n=t.called,h=void 0===n?0:n,l=null,c=1/0,p=new Array(6),u=new Array(6),f=new Array(6),v=0;v<o;v++){for(var d=r/Math.pow(v+1,.16666666666666666),y=0;y<6;y++)p[y]=.5<Math.random()?1:-1,u[y]=i[y]+d*p[y],f[y]=i[y]-d*p[y];for(var b=this.loss(u)-this.loss(f),y=0;y<6;y++){var g=b/(2*d)*p[y],m=s[y]/Math.pow(e+v+1,1);i[y]=this.fixValueByFilterIDX(i[y]-m*g,y)}var x=this.loss(i);x<c&&(l=i.slice(0),c=x)}return{values:l,loss:c,called:h}},s.prototype.loss=function(t){var e=this.reusedColor;e.set(0,0,0),e.invert(t[0]/100),e.sepia(t[1]/100),e.saturate(t[2]/100),e.hueRotate(3.6*t[3]),e.brightness(t[4]/100),e.contrast(t[5]/100);var s=e.hsl();return Math.abs(e.r-this.target.r)+Math.abs(e.g-this.target.g)+Math.abs(e.b-this.target.b)+Math.abs(s.h-this.targetHSL.h)+Math.abs(s.s-this.targetHSL.s)+Math.abs(s.l-this.targetHSL.l)},s.prototype.css=function(s){function t(t,e){return void 0===e&&(e=1),Math.round(s[t]*e)}return["invert("+t(0)+"%)","sepia("+t(1)+"%)","saturate("+t(2)+"%)","hue-rotate("+t(3,3.6)+"deg)","brightness("+t(4)+"%)","contrast("+t(5)+"%);"].join(" ")},s);function s(t,e){this.target=t,this.targetHSL=t.hsl(),this.options=Object.assign({},{acceptanceLossPercentage:5,maxChecks:15},e),this.reusedColor=new c(0,0,0)}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}var f={};t.hexToCSSFilter=function(t,e){var s,r,i,a,o,n;if(void 0===e&&(e={}),f[t]&&!e.forceFilterRecalculation)return Object.assign({},f[t],{cache:!0});try{if(r=(s=function(t,e){var s="function"==typeof Symbol&&t[Symbol.iterator];if(!s)return t;var r,i,a=s.call(t),o=[];try{for(;(void 0===e||0<e--)&&!(r=a.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(s=a.return)&&s.call(a)}finally{if(i)throw i.error}}return o}(4===(n=t).length?[parseInt("0x"+n[1]+n[1]),parseInt("0x"+n[2]+n[2]),parseInt("0x"+n[3]+n[3])]:7===n.length?[parseInt("0x"+n[1]+n[2]),parseInt("0x"+n[3]+n[4]),parseInt("0x"+n[5]+n[6])]:[],3))[0],i=s[1],a=s[2],!u(r)||!u(i)||!u(a))throw new Error("hextToRgb returned an invalid value for '"+t+"'");o=new c(Number(r),Number(i),Number(a))}catch(t){throw new Error("Color value should be in HEX format. "+t)}var h=Object.assign({},{acceptanceLossPercentage:5,maxChecks:30,forceFilterRecalculation:!1},e),l=new p(o,h);return f[t]=Object.assign({},l.solve(),{hex:t,rgb:[r,i,a],cache:!1}),f[t]},Object.defineProperty(t,"__esModule",{value:!0})});